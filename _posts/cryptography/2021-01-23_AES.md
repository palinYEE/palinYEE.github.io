---
layout: post
title:  "[Cryptography] AES (Advanced Encryption Standard)"
date:   2021-01-23T10:00:52-05:00
author: 윤영진
categories: Cryptography
tags: Cryptography AES 
cover:  "/assets/instacode.png"
---

# AES 알고리즘에 대한 정리

암호를 전공한 나에게 AES는 매우 친숙한 암호 알고리즘이다. 아마 보안을 하시는 분들에게도 AES는 매우 친숙할 것이다. 평소에 문서로도 자주 정리했던 AES를 이번 깃 블로그를 운영하면서 한번더 정리해보고자 한다. 본 포스트의 목차는 다음과 같다. 

1. AES 소개
2. AES 에서 사용될 기호 정의
3. 암호화 
4. 복호화
5. 키스케쥴
6. 32비트 룩업 테이블을 이용한 고속 구현

## AES 소개

1997년 NIST는 경쟁 방식에 의거한 표준화를 통해 DES를 대체할 새로운 암호 알고리즘을 공모하였다. (이때, DES 알고리즘은 DES Challenge 3를 통해 22시간 15분 만에 암호 해독이 가능하다는 결론이 나온 상태였다..)
1차 심사를 통과한 알고리즘은 총 15종이였고, 이어서 2차 심사를 통해 5종의 알고리즘이 AES 후보로 선정되었다. 이 중 벨기에 연구자 Joan Daemen과 Vincent Rijmen이 설계한 블록 암호 알고리즘, Rijndael 이 2000년에 AES로 선정되었다. 이 알고리즘이 선정된 이유는 고속 구현이 가능하고 다양한 플랫폼에서 적용 가능하며, 다른 AES 알고리즘 후보들보다 안전성이 우수하다고 평가 받았기 때문이다. 

 AES는 블록의 길이는 128비트, 키의 길이와 라운드 수는 128비트(10라운드), 192비트(12라운드), 256비트(14라운드)로 이루어진 SPN(Substitution Permutation Network) 구조의 블록 암호이다. 키를 생성하는 KeySchedule 함수와 한 라운드를 구성하는 라운드 함수로 구성된다.


 ||마스터 키 길이|라운드 키 길이|입력 비트 길이|라운드 수|
 |:------:|:------:|:------:|:------:|:------:|
 |AES-128|128 비트|128 비트|128 비트|10|
 |AES-192|192 비트|128 비트|128 비트|12|
 |AES-256|256 비트|128 비트|128 비트|14|
 
## AES 에서 사용될 기호 정의
 
AES는 유한체 상에서의 연산으로 간주하여 연산을 진행한다. 그러므로 비트를 다음과 같이 다항식으로 표현한다.

<!-- <center> $b(x) = \sum_{i=0}^{7}b_{i}x^{i} = b_{7}x^{7} + b_{6}x^{6} + b_{5}x^{5} + b_{4}x^{4} + b_{3}x^{3} + b_{2}x^{2} + b_{1}x^{1} + b_{0}$ </center> -->

도한 1바이트는 4비트 2개로 나누어 16진수로 표현이 가능하다. 4비트는 다음 표와 같이 16진수 표기가 이루어진다. 

![16진수](/assets/cryptography/aes/bit.PNG)

위와 같은 바이트 4개를 이어붙여 만든 32비트 비트열은 `Word` 라고 한다. 

##### State
AES 규격서를 보면 `State`라는 용어가 나온다. 이 용어는 간단하다. 16바이트 입력 값을

<!-- <center>$a = a_{0}a_{1}a_{2}\cdots a_{15}$     $a_{i} \in \{0,1\}^{8}$</center> -->

이라고 한다면, State로 변환할 시 다음과 같다. 

<!-- ![state](/assets/cryptography/aes/state.PNG) -->

<!--
<center>
$\left[\begin{array}{rrr} 
a_0&a_4&a_8&a_{12}\\
a_1&a_5&a_9&a_{13}\\
a_2&a_6&a_{10}&a_{14}\\
a_3&a_7&a_{11}&a_{15}
\end{array}\right]$
</center>
 -->
이러한 개념은 간단하지만 뒤에 나올 AES의 암복호화 과정에서 매우 중요한 개념이다. 

##### 기본 연산

기본 연산: AES 알고리듬은 $\{0,1\}^8$에서의 연산을 기본으로 하고 있으며 이는 기약다항식이 $x^8 + x^4 + x^3 + x + 1$인 $GF(2^8)$ 유한체 안에서의 연산으로 간주한다. 유한체에서의 연산 중 덧셈과 곱셈을 사용한다.

* 덧셈: 덧셈: $GF(2^8)$ 유한체 안에서의 덧셈 연산은 다음과 같이 진행된다.
 <!--
    <center>
    $a(x) := a_7x^7 + a_6x^6 + a_5x^5 + a_4x^4 + a_3x^3 + a_2x^2 + a_1x^1 + a_0$  
    $b(x) := b_7x^7 + b_6x^6 + b_5x^5 + b_4x^4 + b_3x^3 + b_2x^2 + b_1x^1 + b_0$  
    $a(x)+b(x) = \sum_{i=0}^{7}( (a_i+b_i)\text{ mod 2 })x^i, ~(a_i, b_i \in \{0,1\}).$
    </center>
-->
    결론적으로 $GF(2^8)$ 유한체 안에서의 덧셈 연산은 비트 간 Xor와 동일하다. AES 알고리듬에서 사용하는 덧셈을 다음과 같은 기호로 정의한다.

    <center>$a\oplus b := a+b.$</center>

* 곱셈 : 곱셈: AES 알고리듬에서 곱셈은 다음과 같이 정의한다. 

<!-- <center>$ a(x) * b(x) := a(x)\times b(x) \pmod {x^8 + x^4+x^3 +x +1}.$</center> -->

##### 기호 

* $Key$: 처음 입력받는 암호화와 복호화 키를 나타낸다. 키의 길이가 128비트일 때를 기준으로, 1bytes씩 나누어 $Key$를 $k_0, k_1, ..., k_{15}$로 입력받는다. 
* $Rk_r$: 각 라운드에 사용되는 라운드 키를 나타낸다. 키의 길이가 128비트일 때를 기준으로, 1bytes씩 나누어 $Rk_r$를 $rk^r_0, rk^r_1, ..., rk^r_{15}$로 표현한다. ($r$은 라운드)
* $RCON$: Word로 이루어진 10개의 라운드 상수이다.
* $a$ $||$ $b$: $a$와 $b$의 연접
* $[a : b]$: $a$번째 비트부터 $b$번째 비트까지의 입력값
* $Inv(a)$: 1bytes 비트열 $a$를 입력으로 하는 함수로, $a$의 $GF(2^8)$상에서의 곱셈에 대한 역원을 출력한다. 단, $a$의 모든 비트가 0일 경우에는 0을 출력한다. 

## 암호화

## 복호화

## 키스케쥴

## 32비트 룩업 테이블 고속 구현
